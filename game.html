<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Details | NeXuS - High Quality HTML5 Games Portal</title>

    <!-- SEO Meta Tags (will be dynamically updated) -->
    <meta name="description" id="meta-description"
        content="Play this exciting HTML5 game directly in your browser. No download required. NeXuS - Your online gaming paradise.">
    <meta name="keywords" content="HTML5 games, free online games, browser games, play games online">
    <meta name="author" content="NeXuS Games">
    <meta name="robots" content="index, follow">
    <link rel="canonical" id="canonical-url" href="https://nexus-games.example.com/game.html">

    <!-- Open Graph / Facebook (will be dynamically updated) -->
    <meta property="og:type" content="website">
    <meta property="og:url" id="og-url" content="https://nexus-games.example.com/game.html">
    <meta property="og:title" id="og-title" content="Play Game | NeXuS Games">
    <meta property="og:description" id="og-description"
        content="Play this exciting HTML5 game directly in your browser.">
    <meta property="og:image" id="og-image" content="https://nexus-games.example.com/og-image.jpg">
    <meta property="og:site_name" content="NeXuS Games">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card (will be dynamically updated) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" id="twitter-url" content="https://nexus-games.example.com/game.html">
    <meta name="twitter:title" id="twitter-title" content="Play Game | NeXuS Games">
    <meta name="twitter:description" id="twitter-description"
        content="Play this exciting HTML5 game directly in your browser.">
    <meta name="twitter:image" id="twitter-image" content="https://nexus-games.example.com/og-image.jpg">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <!-- Styles -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800&family=Audiowide&family=Exo:wght@300;400;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="common.css">

    <!-- Game Data -->
    <script src="games-data.js"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-34PXPKXXLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-34PXPKXXLH');
    </script>

    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function (c, l, a, r, i, t, y) {
            c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
            t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
            y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
        })(window, document, "clarity", "script", "uzk5dc2blx");
    </script>

    <!-- JSON-LD Structured Data (will be dynamically updated) -->
    <script type="application/ld+json" id="game-jsonld">
    {
        "@context": "https://schema.org",
        "@type": "VideoGame",
        "name": "Loading...",
        "description": "An exciting HTML5 game",
        "url": "https://nexus-games.example.com/game.html",
        "applicationCategory": "Game",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "publisher": {
            "@type": "Organization",
            "name": "NeXuS Games"
        }
    }
    </script>

    <!-- Adsterra Popunder Ad -->
    <script src="https://pl28449213.effectivegatecpm.com/4b/ba/e2/4bbae2c6f190c24af6b5a8aeb8a9ffc0.js"></script>
</head>

<body class="min-h-screen">
    <header class="bg-gray-900 bg-opacity-80 backdrop-blur-sm border-b border-purple-600/30 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center gap-2">
                    <a href="index.html"
                        class="text-2xl font-bold text-white title-font glow-text flex items-center gap-2">
                        <img src="favicon.svg" alt="NeXuS Logo" class="w-8 h-8"
                            style="filter: drop-shadow(0 0 8px rgba(98, 0, 234, 0.6));">
                        <span class="text-purple-400">Ne</span><span class="text-teal-400">X</span><span
                            class="text-purple-400">uS</span>
                    </a>
                    <div class="hidden md:flex ml-2 space-x-1" id="game-type-badges">
                        <!-- Game type badges will be added dynamically in JS -->
                    </div>
                </div>
                <nav class="flex mt-4 md:mt-0 space-x-6">
                    <a href="index.html"
                        class="cyber-btn text-white hover:text-teal-400 transition-colors heading-font">Home</a>
                    <a href="about.html"
                        class="cyber-btn text-gray-400 hover:text-teal-400 transition-colors heading-font">About</a>
                    <a href="contact.html"
                        class="cyber-btn text-gray-400 hover:text-teal-400 transition-colors heading-font">Contact</a>
                    <a href="faq.html"
                        class="cyber-btn text-gray-400 hover:text-teal-400 transition-colors heading-font">FAQ</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- Breadcrumb navigation -->
        <div class="mb-6 flex items-center text-sm text-gray-400">
            <a href="index.html" class="hover:text-purple-400">Home</a>
            <span class="mx-2">/</span>
            <a href="index.html" class="hover:text-purple-400">Games</a>
            <span class="mx-2">/</span>
            <span class="text-indigo-400" id="game-title-breadcrumb">Loading...</span>
        </div>

        <!-- Game title section -->
        <div class="mb-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-end">
                <div>
                    <div class="flex items-center">
                        <span id="game-category"
                            class="bg-gray-900/80 text-indigo-400 text-xs px-2 py-1 rounded backdrop-blur-sm border border-indigo-500/30 mr-2">
                            Loading...
                        </span>
                        <div class="flex items-center text-yellow-400">
                            <i class="fas fa-star"></i>
                            <span id="game-rating" class="ml-1 text-gray-300">0.0</span>
                        </div>
                    </div>
                    <h1 id="game-title" class="text-4xl font-bold text-white mt-2 heading-font glow-text">Loading...
                    </h1>
                    <p id="game-tagline" class="text-lg text-gray-300 mt-2">Loading...</p>
                </div>
                <div class="mt-4 md:mt-0 flex space-x-3">
                    <button
                        class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded neo-brutalism transition-all hover:-translate-y-1 heading-font flex items-center">
                        <i class="fas fa-heart mr-2"></i> Favorite
                    </button>
                    <button
                        class="px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded neo-brutalism transition-all hover:-translate-y-1 heading-font flex items-center">
                        <i class="fas fa-share-alt mr-2"></i> Share
                    </button>
                </div>
            </div>
        </div>

        <!-- Game content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Main content -->
            <div class="lg:col-span-2">
                <!-- Game Iframe -->
                <div class="game-detail-card rounded-xl overflow-hidden mb-6" style="overflow: hidden;">
                    <div class="iframe-container" id="game-container">
                        <button class="fullscreen-btn" id="fullscreen-btn" title="全屏播放 / Fullscreen">
                            <i class="fas fa-expand"></i>
                            <span>全屏</span>
                        </button>
                        <iframe id="game-iframe" src="about:blank" allowfullscreen scrolling="no" title="Game Player"
                            loading="lazy" style="overflow: hidden;"></iframe>
                    </div>
                </div>

                <!-- Game description -->
                <div class="game-detail-card rounded-xl p-6 mb-6">
                    <h2 class="text-xl font-bold text-white mb-4 heading-font">Game Details</h2>
                    <p id="game-description" class="text-gray-300 mb-4">
                        Loading...
                    </p>
                    <p id="game-long-description" class="text-gray-300 mb-4">
                        Loading...
                    </p>
                    <h3 class="text-lg font-semibold text-white mt-6 mb-3 heading-font">Game Features</h3>
                    <ul id="game-features" class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2">
                        <li class="game-feature">Loading...</li>
                    </ul>
                </div>

                <!-- Game gameplay and tips -->
                <div class="game-detail-card rounded-xl p-6 mb-6">
                    <h2 class="text-xl font-bold text-white mb-4 heading-font">Gameplay</h2>
                    <p id="game-gameplay" class="text-gray-300 mb-6">
                        Loading...
                    </p>

                    <h3 class="text-lg font-semibold text-white mt-6 mb-3 heading-font">Game Tips</h3>
                    <ul id="game-tips" class="space-y-3">
                        <li class="flex">
                            <span class="text-indigo-400 mr-2"><i class="fas fa-lightbulb"></i></span>
                            <span>Loading...</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-1">
                <!-- Game controls -->
                <div class="game-detail-card rounded-xl p-6 mb-6">
                    <h2 class="text-xl font-bold text-white mb-4 heading-font">Game Controls</h2>
                    <ul id="game-controls" class="space-y-3">
                        <li class="control-item">Loading...</li>
                    </ul>
                </div>

                <!-- Game information -->
                <div class="game-detail-card rounded-xl p-6 mb-6">
                    <h2 class="text-xl font-bold text-white mb-4 heading-font">Game Information</h2>
                    <div class="space-y-4">
                        <div>
                            <span class="text-gray-400 block">Developer</span>
                            <span id="game-developer" class="text-gray-200">Loading...</span>
                        </div>
                        <div>
                            <span class="text-gray-400 block">Release Date</span>
                            <span id="game-release-date" class="text-gray-200">Loading...</span>
                        </div>
                        <div>
                            <span class="text-gray-400 block">Genre</span>
                            <span id="game-genre" class="text-gray-200">Loading...</span>
                        </div>
                        <div>
                            <span class="text-gray-400 block">Platforms</span>
                            <span id="game-platforms" class="text-gray-200">Loading...</span>
                        </div>
                        <div>
                            <span class="text-gray-400 block">Age Rating</span>
                            <span id="game-age-rating" class="text-gray-200">Loading...</span>
                        </div>
                        <div>
                            <span class="text-gray-400 block">Languages</span>
                            <span id="game-languages" class="text-gray-200">Loading...</span>
                        </div>
                    </div>
                </div>

                <!-- Similar games -->
                <div class="game-detail-card rounded-xl p-6">
                    <h2 class="text-xl font-bold text-white mb-4 heading-font">Recommended Games</h2>
                    <div id="similar-games-container" class="space-y-4">
                        <div class="similar-game-card p-3 rounded-lg flex items-center">
                            <div class="w-20 h-20 bg-gray-700 rounded animate-pulse"></div>
                            <div class="ml-3 w-full">
                                <div class="h-4 bg-gray-700 rounded w-3/4 mb-2 animate-pulse"></div>
                                <div class="h-3 bg-gray-700 rounded w-1/2 animate-pulse"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-900 bg-opacity-80 backdrop-blur-sm border-t border-purple-600/30 mt-12">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="text-center">
                <div class="text-xl font-bold title-font mb-4">
                    <span class="text-purple-400">Ne</span><span class="text-teal-400">X</span><span
                        class="text-purple-400">uS</span>
                </div>
                <p class="text-gray-400 text-sm">
                    &copy; 2025 NeXuS. All rights reserved. Best HTML5 web games platform.
                </p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get game ID from URL parameters
            const params = new URLSearchParams(window.location.search);
            const gameId = params.get('id');

            if (!gameId) {
                alert('Game ID not specified, returning to homepage.');
                window.location.href = 'index.html';
                return;
            }

            // Get game data from games-data.js
            const game = getGameById(gameId);

            if (!game) {
                // Create custom error modal instead of using alert
                const errorModal = document.createElement('div');
                errorModal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';
                errorModal.innerHTML = `
                    <div class="bg-gray-800 p-6 rounded-lg max-w-md w-full border border-purple-500/30">
                        <h2 class="text-xl font-bold text-white mb-4 heading-font">Game Not Found / Game Not Found</h2>
                        <p class="text-gray-300 mb-6">The specified game ID "${gameId}"does not exist or has been removed. Returning to homepage.<br><br>The specified game ID "${gameId}" does not exist or has been removed. Returning to homepage.</p>
                        <div class="flex justify-end">
                            <button id="errorOkBtn" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded transition-all heading-font">OK / OK</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(errorModal);

                // Add event listener to OK button
                document.getElementById('errorOkBtn').addEventListener('click', function () {
                    window.location.href = 'index.html';
                });

                // Auto redirect after 5 seconds
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 5000);

                return;
            }

            // Update page title
            document.title = `${game.title} | NeXuS - High Quality HTML5 Games Portal`;

            // Update SEO meta tags dynamically
            const gameUrl = `https://nexus-games.example.com/game.html?id=${game.id}`;

            // Update meta description
            document.getElementById('meta-description').setAttribute('content', game.description);

            // Update canonical URL
            document.getElementById('canonical-url').setAttribute('href', gameUrl);

            // Update Open Graph tags
            document.getElementById('og-url').setAttribute('content', gameUrl);
            document.getElementById('og-title').setAttribute('content', `${game.title} | Play Free on NeXuS`);
            document.getElementById('og-description').setAttribute('content', game.tagline);
            document.getElementById('og-image').setAttribute('content', game.thumbnail);

            // Update Twitter Card tags
            document.getElementById('twitter-url').setAttribute('content', gameUrl);
            document.getElementById('twitter-title').setAttribute('content', `${game.title} | Play Free on NeXuS`);
            document.getElementById('twitter-description').setAttribute('content', game.tagline);
            document.getElementById('twitter-image').setAttribute('content', game.thumbnail);

            // Update JSON-LD structured data
            const jsonLdData = {
                "@context": "https://schema.org",
                "@type": "VideoGame",
                "name": game.title,
                "description": game.description,
                "url": gameUrl,
                "image": game.thumbnail,
                "genre": game.genre,
                "applicationCategory": "Game",
                "operatingSystem": "Web Browser",
                "aggregateRating": {
                    "@type": "AggregateRating",
                    "ratingValue": game.rating,
                    "bestRating": "5",
                    "worstRating": "1"
                },
                "offers": {
                    "@type": "Offer",
                    "price": "0",
                    "priceCurrency": "USD"
                },
                "publisher": {
                    "@type": "Organization",
                    "name": game.developer || "NeXuS Games"
                }
            };
            document.getElementById('game-jsonld').textContent = JSON.stringify(jsonLdData);

            // Update iframe title for accessibility
            document.getElementById('game-iframe').setAttribute('title', `Play ${game.title}`);

            // Update breadcrumb navigation
            document.getElementById('game-title-breadcrumb').textContent = game.title;

            // Update game type badges
            const gameTypeBadges = document.getElementById('game-type-badges');
            gameTypeBadges.innerHTML = '';

            if (game.type === '3d') {
                gameTypeBadges.innerHTML = '<span class="text-xs py-1 px-2 bg-purple-900/50 rounded-md border border-purple-500/20">3D</span>';
            } else {
                gameTypeBadges.innerHTML = '<span class="text-xs py-1 px-2 bg-blue-600/50 rounded-md border border-blue-500/20">2D</span>';
            }

            // Update game title section
            document.getElementById('game-title').textContent = game.title;
            document.getElementById('game-tagline').textContent = game.tagline;
            document.getElementById('game-rating').textContent = game.rating;

            // Update game category
            const categoryElement = document.getElementById('game-category');
            categoryElement.textContent = getCategoryDisplayName(game.category);
            categoryElement.className = `bg-gray-900/80 text-${getCategoryColor(game.category)}-400 text-xs px-2 py-1 rounded backdrop-blur-sm border border-${getCategoryColor(game.category)}-500/30 mr-2`;

            // Update game iframe
            document.getElementById('game-iframe').src = game.iframe;

            // Update game description
            document.getElementById('game-description').textContent = game.description;
            document.getElementById('game-long-description').textContent = game.longDescription;

            // Update game features
            const featuresContainer = document.getElementById('game-features');
            featuresContainer.innerHTML = '';

            game.features.forEach(feature => {
                const li = document.createElement('li');
                li.className = 'game-feature';
                li.textContent = feature;
                featuresContainer.appendChild(li);
            });

            // Update gameplay
            document.getElementById('game-gameplay').textContent = game.gameplayDescription;

            // Update game tips
            const tipsContainer = document.getElementById('game-tips');
            tipsContainer.innerHTML = '';

            game.tips.forEach(tip => {
                const li = document.createElement('li');
                li.className = 'flex';
                li.innerHTML = `
                    <span class="text-indigo-400 mr-2"><i class="fas fa-lightbulb"></i></span>
                    <span>${tip}</span>
                `;
                tipsContainer.appendChild(li);
            });

            // Update game controls
            const controlsContainer = document.getElementById('game-controls');
            controlsContainer.innerHTML = '';

            game.controls.forEach(control => {
                const li = document.createElement('li');
                li.className = 'control-item';
                li.textContent = control;
                controlsContainer.appendChild(li);
            });

            // Update game information
            document.getElementById('game-developer').textContent = game.developer;
            document.getElementById('game-release-date').textContent = game.releaseDate;
            document.getElementById('game-genre').textContent = game.genre;
            document.getElementById('game-platforms').textContent = game.platforms;
            document.getElementById('game-age-rating').textContent = game.ageRating;
            document.getElementById('game-languages').textContent = game.languages;

            // Update similar games
            const similarGamesContainer = document.getElementById('similar-games-container');
            similarGamesContainer.innerHTML = '';

            if (game.similarGames && game.similarGames.length > 0) {
                game.similarGames.forEach(similarGame => {
                    const gameCard = document.createElement('a');
                    gameCard.href = `game.html?id=${similarGame.id}`;
                    gameCard.className = 'similar-game-card p-3 rounded-lg flex items-center';

                    gameCard.innerHTML = `
                        <img src="${similarGame.thumbnail}" alt="${similarGame.title}" class="w-20 h-20 object-cover rounded">
                        <div class="ml-3">
                            <h3 class="text-white font-medium">${similarGame.title}</h3>
                                <div class="flex items-center">
                                <span class="text-sm text-${getCategoryColor(similarGame.category)}-400">${getCategoryDisplayName(similarGame.category)}</span>
                                <div class="ml-auto flex items-center">
                                    <i class="fas fa-star text-yellow-400 text-xs"></i>
                                    <span class="text-xs ml-1">${similarGame.rating}</span>
                                </div>
                            </div>
                        </div>
                    `;

                    similarGamesContainer.appendChild(gameCard);
                });
            } else {
                const noSimilarGames = document.createElement('p');
                noSimilarGames.className = 'text-gray-400 text-center py-4';
                noSimilarGames.textContent = 'No recommended games available';
                similarGamesContainer.appendChild(noSimilarGames);
            }

            // 全屏功能实现
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const gameContainer = document.getElementById('game-container');

            if (fullscreenBtn && gameContainer) {
                fullscreenBtn.addEventListener('click', function () {
                    toggleFullscreen();
                });

                // 监听全屏状态变化
                document.addEventListener('fullscreenchange', updateFullscreenButton);
                document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
                document.addEventListener('mozfullscreenchange', updateFullscreenButton);
                document.addEventListener('MSFullscreenChange', updateFullscreenButton);
            }

            function toggleFullscreen() {
                if (!document.fullscreenElement &&
                    !document.webkitFullscreenElement &&
                    !document.mozFullScreenElement &&
                    !document.msFullscreenElement) {
                    // 进入全屏
                    if (gameContainer.requestFullscreen) {
                        gameContainer.requestFullscreen();
                    } else if (gameContainer.webkitRequestFullscreen) {
                        gameContainer.webkitRequestFullscreen();
                    } else if (gameContainer.mozRequestFullScreen) {
                        gameContainer.mozRequestFullScreen();
                    } else if (gameContainer.msRequestFullscreen) {
                        gameContainer.msRequestFullscreen();
                    }
                } else {
                    // 退出全屏
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        document.mozCancelFullScreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            }

            function updateFullscreenButton() {
                const isFullscreen = document.fullscreenElement ||
                    document.webkitFullscreenElement ||
                    document.mozFullScreenElement ||
                    document.msFullscreenElement;

                const icon = fullscreenBtn.querySelector('i');
                const text = fullscreenBtn.querySelector('span');

                if (isFullscreen) {
                    icon.className = 'fas fa-compress';
                    text.textContent = '退出';
                } else {
                    icon.className = 'fas fa-expand';
                    text.textContent = '全屏';
                }
            }
        });

        // Helper function for category display names
        function getCategoryDisplayName(category) {
            const categoryNames = {
                'action': 'Action Games',
                'adventure': 'Adventure Games',
                'shooter': 'Shooter Games',
                'racing': 'Racing Games',
                'exploration': 'Exploration Games',
                'sandbox': 'Sandbox Games',
                'arcade': 'Arcade Games',
                'puzzle': 'Puzzle Games',
                'sports': 'Sports Games',
                'strategy': 'Strategy Games',
                'idle': 'Idle Games',
                'simulation': 'Simulation Games',
                'all': 'All Games'
            };

            return categoryNames[category] || category;
        }
    </script>
</body>

</html>